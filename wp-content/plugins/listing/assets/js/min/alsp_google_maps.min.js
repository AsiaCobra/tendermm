if(alsp_js_objects.is_maps_used&&!alsp_maps_objects.notinclude_maps_api){var alsp_3rd_party_maps_plugin=!1,_warn=console.warn,_error=console.error;console.error=function(){var e=arguments[0];if("string"==typeof e){if(-1==e.indexOf("InvalidKeyMapError")&&-1==e.indexOf("MissingKeyMapError")||(alsp_3rd_party_maps_plugin?alert("Ads Listing System plugin: another plugin or your theme calls Google Maps library without keys. This may cause problems with Google Maps, Geocoding, addition/edition listings locations, autocomplete on addresses fields.\n\nTry to find which plugin calls Google Maps library without keys. Insert keys in its settings or disable this plugin."):alert("Ads Listing System plugin: your Google browser API key is invalid or missing. Log in to console https://code.google.com/apis/console and generate new key. Follow instructions https://designinvento.ticksy.com/article/13440/")),-1!=e.indexOf("RefererNotAllowedMapError")){var a=window.location.hostname.replace("www.",""),t=window.location.protocol;alert('Ads Listing System plugin: the current URL loading the Google Maps has not been added to the list of allowed referrers. Please check the "Accept requests from these HTTP referrers (web sites)" field in Google API console. Follow instructions http://www.salephpscripts.com/wordpress_directory/demo/documentation/#google_maps_keys \n\nTry one of the following URLs: *.'+a+"/*, "+t+"//"+a+"/*, "+t+"//www."+a+"/*")}-1!=e.indexOf("ApiNotActivatedMapError")&&alert("Ads Listing System plugin: you have to enable following APIs in Google API console https://code.google.com/apis/console : Google Maps JavaScript API, Google Static Maps API, Google Places API Web Service, Google Maps Geocoding API and Google Maps Directions API. Follow instructions http://www.salephpscripts.com/wordpress_directory/demo/documentation/#google_maps_keys\n\nNote, that it requires some time for changes to take effect."),-1!=e.indexOf("You have exceeded your request quota for this API.")&&alert("Google Maps is no longer free. You must enable billing with a credit card and have a valid API key for all of your projects. https://developers.google.com/maps/billing/understanding-cost-of-use")}return _error.apply(console,arguments)},console.warn=function(){var e=arguments[0];return"string"==typeof e&&(-1==e.indexOf("InvalidKey")&&-1==e.indexOf("NoApiKeys")||(alsp_3rd_party_maps_plugin?alert("Ads Listing System plugin: another plugin or your theme calls Google Maps library without keys. This may cause problems with Google Maps, Geocoding, addition/edition listings locations, autocomplete on addresses fields.\n\nTry to find which plugin calls Google Maps library without keys. Insert keys in its settings or disable this plugin."):alert("Ads Listing System plugin: your Google browser API key is invalid or missing. Log in to console https://code.google.com/apis/console and generate new key. Follow instructions https://designinvento.ticksy.com/article/13440/"))),_warn.apply(console,arguments)}}function alsp_load_richtext(){!function(){var e=!0,a=!1;function t(t){var o=t||{};this.d=this.c=a,void 0==t.visible&&(t.visible=e),void 0==t.shadow&&(t.shadow="7px -3px 5px rgba(88,88,88,0.7)"),void 0==t.anchor&&(t.anchor=l.BOTTOM),this.setValues(o)}function o(e,a){if(e.c){var t="";-1!==navigator.userAgent.indexOf("Gecko/")?("dragging"==a&&(t="-moz-grabbing"),"dragready"==a&&(t="-moz-grab")):"dragging"!=a&&"dragready"!=a||(t="move"),"draggable"==a&&(t="pointer"),e.a.style.cursor!=t&&(e.a.style.cursor=t)}}function s(e){e.getDraggable()&&e.d&&(e.d=a,e.getMap().set("draggable",e.m),e.h=e.i=e.m=null,e.a.style.MozUserSelect="",e.a.style.KhtmlUserSelect="",e.a.style.WebkitUserSelect="",e.a.unselectable="off",e.a.onselectstart=function(){},function(e){if(e.e){for(var a,t=0;a=e.e[t];t++)google.maps.event.removeListener(a);e.e.length=0}}(e),o(e,"draggable"),google.maps.event.trigger(e,"dragend"),e.draw())}function i(e,a){if(e.getDraggable()&&e.d){var t=e.h-a.clientX,i=e.i-a.clientY;e.h=a.clientX,e.i=a.clientY,t=parseInt(e.a.style.left,10)-t,i=parseInt(e.a.style.top,10)-i,e.a.style.left=t+"px",e.a.style.top=i+"px";var n=r(e);e.setPosition(e.getProjection().fromDivPixelToLatLng(new google.maps.Point(t-n.width,i-n.height))),o(e,"dragging"),google.maps.event.trigger(e,"drag")}else s(e)}function n(e){e.f&&(google.maps.event.removeListener(e.f),delete e.f),o(e,"")}function r(e){var a=e.l();if("object"==typeof a)return a;var t=new google.maps.Size(0,0);if(!e.b)return t;var o=e.b.offsetWidth;switch(e=e.b.offsetHeight,a){case l.TOP:t.width=-o/2;break;case l.TOP_RIGHT:t.width=-o;break;case l.LEFT:t.height=-e/2;break;case l.MIDDLE:t.width=-o/2,t.height=-e/2;break;case l.RIGHT:t.width=-o,t.height=-e/2;break;case l.BOTTOM_LEFT:t.height=-e;break;case l.BOTTOM:t.width=-o/2,t.height=-e;break;case l.BOTTOM_RIGHT:t.width=-o,t.height=-e}return t}t.prototype=new google.maps.OverlayView,window.RichMarker=t,t.prototype.getVisible=function(){return this.get("visible")},t.prototype.getVisible=t.prototype.getVisible,t.prototype.setVisible=function(e){this.set("visible",e)},t.prototype.setVisible=t.prototype.setVisible,t.prototype.s=function(){this.c&&(this.a.style.display=this.getVisible()?"":"none",this.draw())},t.prototype.visible_changed=t.prototype.s,t.prototype.setFlat=function(e){this.set("flat",!!e)},t.prototype.setFlat=t.prototype.setFlat,t.prototype.getFlat=function(){return this.get("flat")},t.prototype.getFlat=t.prototype.getFlat,t.prototype.p=function(){return this.get("width")},t.prototype.getWidth=t.prototype.p,t.prototype.o=function(){return this.get("height")},t.prototype.getHeight=t.prototype.o,t.prototype.setShadow=function(e){this.set("shadow",e),this.g()},t.prototype.setShadow=t.prototype.setShadow,t.prototype.getShadow=function(){return this.get("shadow")},t.prototype.getShadow=t.prototype.getShadow,t.prototype.g=function(){this.c&&(this.a.style.boxShadow=this.a.style.webkitBoxShadow=this.a.style.MozBoxShadow=this.getFlat()?"":this.getShadow())},t.prototype.flat_changed=t.prototype.g,t.prototype.setZIndex=function(e){this.set("zIndex",e)},t.prototype.setZIndex=t.prototype.setZIndex,t.prototype.getZIndex=function(){return this.get("zIndex")},t.prototype.getZIndex=t.prototype.getZIndex,t.prototype.t=function(){this.getZIndex()&&this.c&&(this.a.style.zIndex=this.getZIndex())},t.prototype.zIndex_changed=t.prototype.t,t.prototype.getDraggable=function(){return this.get("draggable")},t.prototype.getDraggable=t.prototype.getDraggable,t.prototype.setDraggable=function(e){this.set("draggable",!!e)},t.prototype.setDraggable=t.prototype.setDraggable,t.prototype.k=function(){var t,r;this.c&&(this.getDraggable()?(t=this,(r=this.a)&&(t.f=google.maps.event.addDomListener(r,"mousedown",function(n){!function(t,n){if(t.getDraggable()&&!t.d){t.d=e;var r=t.getMap();t.m=r.get("draggable"),r.set("draggable",a),t.h=n.clientX,t.i=n.clientY,o(t,"dragready"),t.a.style.MozUserSelect="none",t.a.style.KhtmlUserSelect="none",t.a.style.WebkitUserSelect="none",t.a.unselectable="on",t.a.onselectstart=function(){return a},(l=t).a.setCapture?(l.a.setCapture(e),l.e=[google.maps.event.addDomListener(l.a,"mousemove",function(e){i(l,e)},e),google.maps.event.addDomListener(l.a,"mouseup",function(){s(l),l.a.releaseCapture()},e)]):l.e=[google.maps.event.addDomListener(window,"mousemove",function(e){i(l,e)},e),google.maps.event.addDomListener(window,"mouseup",function(){s(l)},e)],google.maps.event.trigger(t,"dragstart")}var l}(t,n)}),o(t,"draggable"))):n(this))},t.prototype.draggable_changed=t.prototype.k,t.prototype.getPosition=function(){return this.get("position")},t.prototype.getPosition=t.prototype.getPosition,t.prototype.setPosition=function(e){this.set("position",e)},t.prototype.setPosition=t.prototype.setPosition,t.prototype.q=function(){this.draw()},t.prototype.position_changed=t.prototype.q,t.prototype.l=function(){return this.get("anchor")},t.prototype.getAnchor=t.prototype.l,t.prototype.r=function(e){this.set("anchor",e)},t.prototype.setAnchor=t.prototype.r,t.prototype.n=function(){this.draw()},t.prototype.anchor_changed=t.prototype.n,t.prototype.setContent=function(e){this.set("content",e)},t.prototype.setContent=t.prototype.setContent,t.prototype.getContent=function(){return this.get("content")},t.prototype.getContent=t.prototype.getContent,t.prototype.j=function(){if(this.b){!function(e,a){if(a)for(var t;t=a.firstChild;)a.removeChild(t)}(0,this.b);var e=this.getContent();if(e){"string"==typeof e&&(e=function(e,a){var t=document.createElement("DIV");if(t.innerHTML=a,1==t.childNodes.length)return t.removeChild(t.firstChild);for(var o=document.createDocumentFragment();t.firstChild;)o.appendChild(t.firstChild);return o}(0,e=e.replace(/^\s*([\S\s]*)\b\s*$/,"$1"))),this.b.appendChild(e);var t=this;e=this.b.getElementsByTagName("IMG");for(var o,s=0;o=e[s];s++)google.maps.event.addDomListener(o,"mousedown",function(e){t.getDraggable()&&(e.preventDefault&&e.preventDefault(),e.returnValue=a)}),google.maps.event.addDomListener(o,"load",function(){t.draw()});google.maps.event.trigger(this,"domready")}this.c&&this.draw()}},t.prototype.content_changed=t.prototype.j,t.prototype.onAdd=function(){if(this.a||(this.a=document.createElement("DIV"),this.a.style.position="absolute"),this.getZIndex()&&(this.a.style.zIndex=this.getZIndex()),this.a.style.display=this.getVisible()?"":"none",!this.b){this.b=document.createElement("DIV"),this.a.appendChild(this.b);var a=this;google.maps.event.addDomListener(this.b,"click",function(){google.maps.event.trigger(a,"click")}),google.maps.event.addDomListener(this.b,"mouseover",function(){google.maps.event.trigger(a,"mouseover")}),google.maps.event.addDomListener(this.b,"mouseout",function(){google.maps.event.trigger(a,"mouseout")})}this.c=e,this.j(),this.g(),this.k();var t=this.getPanes();t&&t.overlayImage.appendChild(this.a),google.maps.event.trigger(this,"ready")},t.prototype.onAdd=t.prototype.onAdd,t.prototype.draw=function(){if(this.c&&!this.d){var e=this.getProjection();if(e){var a=this.get("position");e=e.fromLatLngToDivPixel(a),a=r(this),this.a.style.top=e.y+a.height+"px",this.a.style.left=e.x+a.width+"px",e=this.b.offsetHeight,(a=this.b.offsetWidth)!=this.get("width")&&this.set("width",a),e!=this.get("height")&&this.set("height",e)}}},t.prototype.draw=t.prototype.draw,t.prototype.onRemove=function(){this.a&&this.a.parentNode&&this.a.parentNode.removeChild(this.a),n(this)},t.prototype.onRemove=t.prototype.onRemove;var l={TOP_LEFT:1,TOP:2,TOP_RIGHT:3,LEFT:4,MIDDLE:5,RIGHT:6,BOTTOM_LEFT:7,BOTTOM:8,BOTTOM_RIGHT:9};window.RichMarkerPosition=l}()}!function($){"use strict";var alsp_load_maps_backend=function(){if(alsp_geocoder_backend=new google.maps.Geocoder,$("#alsp-maps-canvas").length){var mapOptions={zoom:1,scrollwheel:!0,gestureHandling:"greedy",disableDoubleClickZoom:!0,mapTypeId:google.maps.MapTypeId.ROADMAP,fullscreenControl:!1};alsp_maps_objects.map_style&&(mapOptions.styles=eval(alsp_maps_objects.map_style)),alsp_map_backend=new google.maps.Map(document.getElementById("alsp-maps-canvas"),mapOptions);var alsp_coords_array_1=new Array,alsp_coords_array_2=new Array;alsp_isAnyLocation_backend()?alsp_generateMap_backend():alsp_map_backend.setCenter(new google.maps.LatLng(34,0)),google.maps.event.addListener(alsp_map_backend,"zoom_changed",function(){alsp_allow_map_zoom_backend&&$(".alsp-map-zoom").val(alsp_map_backend.getZoom())})}};function alsp_setMapCenter_backend(e,a){for(var t=0,o=new google.maps.LatLngBounds;t<e.length;t++)o.extend(new google.maps.LatLng(e[t],a[t]));if(1==t)if(""==$(".alsp-map-zoom").val()||0==$(".alsp-map-zoom").val())var s=1;else s=parseInt($(".alsp-map-zoom").val());else{alsp_map_backend.fitBounds(o);s=alsp_map_backend.getZoom()}alsp_map_backend.setCenter(o.getCenter()),alsp_allow_map_zoom_backend=!1,alsp_map_backend.setZoom(s),alsp_allow_map_zoom_backend=!0}window.alsp_load_maps_api_backend=function(){$(document).trigger("alsp_google_maps_api_loaded"),google.maps.event.addDomListener(window,"load",alsp_load_maps_backend()),alsp_load_maps_api(),alsp_setupAutocomplete()},window.alsp_setupAutocomplete=function(){$(".alsp-field-autocomplete").each(function(){if(google.maps&&google.maps.places){if(""!=alsp_maps_objects.address_autocomplete_code)var e={componentRestrictions:{country:alsp_maps_objects.address_autocomplete_code}};else e={};var a=new google.maps.places.Autocomplete(this,e);$("#alsp-maps-canvas").length&&google.maps.event.addListener(a,"place_changed",function(){alsp_generateMap_backend()})}})};var alsp_coords_array_1=new Array,alsp_coords_array_2=new Array,alsp_attempts=0;function alsp_setFoundPoint(e,a,t){var o=e[0].geometry.location;$(".alsp-map-coords-1:eq("+t+")").val(o.lat()),$(".alsp-map-coords-2:eq("+t+")").val(o.lng());var s=o.lat(),i=o.lng();alsp_coords_array_1.push(s),alsp_coords_array_2.push(i),a.setPoint(o),a.alsp_placeMarker(),alsp_geocodeAddress_backend(t+1),t+1==$(".alsp-location-in-metabox").length&&(alsp_setMapCenter_backend(alsp_coords_array_1,alsp_coords_array_2),alsp_ajax_loader_target_hide("alsp-maps-canvas"))}function alsp_show_infoWindow_backend(e,a){var t=e.compileHtmlAddress();e.index;alsp_infoWindow_backend||(alsp_infoWindow_backend=new google.maps.InfoWindow),alsp_infoWindow_backend.setContent(t),alsp_infoWindow_backend.open(alsp_map_backend,a)}function alsp_clearOverlays_backend(){if(alsp_markersArray_backend)for(var e=0;e<alsp_markersArray_backend.length;e++)alsp_markersArray_backend[e].setMap(null)}function alsp_isAnyLocation_backend(){var e=!1;return $(".alsp-location-in-metabox").each(function(a,t){if($(this).find("select").each(function(a,t){if($(this).val())return e=!0,!1}),$(".alsp-manual-coords:eq("+a+")").is(":checked")&&""!=$(".alsp-map-coords-1:eq("+a+")").val()&&""!=$(".alsp-map-coords-2:eq("+a+")").val()&&(0!=$(".alsp-map-coords-1:eq("+a+")").val()||0!=$(".alsp-map-coords-2:eq("+a+")").val()))return e=!0,!1}),!!e||(0!=$(".alsp-address-line-1[value!='']").length||(0!=$(".alsp-address-line-2[value!='']").length||(0!=$(".alsp-zip-or-postal-index[value!='']").length||void 0)))}window.alsp_generateMap_backend=function(){alsp_ajax_loader_target_show($("#alsp-maps-canvas")),alsp_coords_array_1=new Array,alsp_coords_array_2=new Array,alsp_attempts=0,alsp_clearOverlays_backend(),alsp_geocodeAddress_backend(0),alsp_setupAutocomplete()},window.alsp_geocodeAddress_backend=function(e){if($(".alsp-location-in-metabox:eq("+e+")").length){var a=[];$(".alsp-location-in-metabox:eq("+e+")").find("select").each(function(e,t){$(this).val()&&a.push($(this).children(":selected").text())});var t=a.reverse().join(", ");if(!$(".alsp-manual-coords:eq("+e+")").is(":checked")||""==$(".alsp-map-coords-1:eq("+e+")").val()||""==$(".alsp-map-coords-2:eq("+e+")").val()||0==$(".alsp-map-coords-1:eq("+e+")").val()&&0==$(".alsp-map-coords-2:eq("+e+")").val())if(t||$(".alsp-address-line-1:eq("+e+")").val()||$(".alsp-address-line-2:eq("+e+")").val()||$(".alsp-zip-or-postal-index:eq("+e+")").val()){n=new alsp_glocation_backend(e,null,t,$(".alsp-address-line-1:eq("+e+")").val(),$(".alsp-address-line-2:eq("+e+")").val(),$(".alsp-zip-or-postal-index:eq("+e+")").val(),$(".alsp-map-icon-file:eq("+e+")").val());if("0"!=alsp_maps_objects.address_autocomplete_code)var o={address:n.compileAddress(),componentRestrictions:{country:alsp_maps_objects.address_autocomplete_code}};else o={address:n.compileAddress()};null!==alsp_geocoder_backend?alsp_geocoder_backend.geocode(o,function(a,t){if(t!=google.maps.GeocoderStatus.OK)if(t==google.maps.GeocoderStatus.OVER_QUERY_LIMIT&&alsp_attempts<5)alsp_attempts++,setTimeout("alsp_geocodeAddress_backend("+e+")",2e3);else if(t==google.maps.GeocoderStatus.ZERO_RESULTS){new google.maps.places.PlacesService(alsp_map_backend).textSearch({query:o.address},function(a,t){t==google.maps.places.PlacesServiceStatus.OK?alsp_setFoundPoint(a,n,e):(alert("Sorry, we are unable to geocode that address (address #"+e+") for the following reason: "+t),alsp_ajax_loader_target_hide("alsp-maps-canvas"))})}else alert("Sorry, we are unable to geocode that address (address #"+e+") for the following reason: "+t),alsp_ajax_loader_target_hide("alsp-maps-canvas");else alsp_setFoundPoint(a,n,e)}):(alert("Google Geocoder was not loaded. Check Google API keys and enable Google Maps Geocoding API in Google APIs console."),alsp_ajax_loader_target_hide("alsp-maps-canvas"))}else alsp_ajax_loader_target_hide("alsp-maps-canvas");else{var s=$(".alsp-map-coords-1:eq("+e+")").val(),i=$(".alsp-map-coords-2:eq("+e+")").val();if($.isNumeric(s)&&$.isNumeric(i)){var n,r=new google.maps.LatLng(s,i);alsp_coords_array_1.push(s),alsp_coords_array_2.push(i),(n=new alsp_glocation_backend(e,r,t,$(".alsp-address-line-1:eq("+e+")").val(),$(".alsp-address-line-2:eq("+e+")").val(),$(".alsp-zip-or-postal-index:eq("+e+")").val(),$(".alsp-map-icon-file:eq("+e+")").val())).alsp_placeMarker()}alsp_geocodeAddress_backend(e+1),e+1==$(".alsp-location-in-metabox").length&&(alsp_setMapCenter_backend(alsp_coords_array_1,alsp_coords_array_2),alsp_ajax_loader_target_hide("alsp-maps-canvas"))}}else alsp_attempts=0},window.alsp_placeMarker_backend=function(e){if("icons"!=alsp_maps_objects.map_markers_type){if(""!=alsp_maps_objects.global_map_icons_path){if(e.map_icon_file&&void 0!==/(?:\.([^.]+))?$/.exec(alsp_maps_objects.global_map_icons_path+"icons/"+e.map_icon_file)[1])var a=alsp_maps_objects.global_map_icons_path+"icons/"+e.map_icon_file;else a=alsp_maps_objects.global_map_icons_path+"blank.png";var t={url:a,size:new google.maps.Size(parseInt(alsp_maps_objects.marker_image_width),parseInt(alsp_maps_objects.marker_image_height)),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(parseInt(alsp_maps_objects.marker_image_anchor_x),parseInt(alsp_maps_objects.marker_image_anchor_y))},o=new google.maps.Marker({position:e.point,map:alsp_map_backend,icon:t,draggable:!0})}else o=new google.maps.Marker({position:e.point,map:alsp_map_backend,draggable:!0});alsp_markersArray_backend.push(o),google.maps.event.addListener(o,"click",function(){alsp_show_infoWindow_backend(e,o)}),google.maps.event.addListener(o,"dragend",function(a){var t=o.getPosition();if(void 0!==t){e.index;$(".alsp-manual-coords:eq("+e.index+")").attr("checked",!0),$(".alsp-manual-coords:eq("+e.index+")").parents(".alsp-manual-coords-wrapper").find(".alsp-manual-coords-block").show(200),$(".alsp-map-coords-1:eq("+e.index+")").val(t.lat()),$(".alsp-map-coords-2:eq("+e.index+")").val(t.lng())}})}else{alsp_load_richtext();var s=!1,i=!1;if(!e.map_icon_file||"string"==typeof location.map_icon_file&&-1==e.map_icon_file.indexOf("fa-")?!s&&alsp_maps_objects.default_marker_icon&&(s=alsp_maps_objects.default_marker_icon):s=e.map_icon_file,i||(i=alsp_maps_objects.default_marker_color?alsp_maps_objects.default_marker_color:"#2393ba"),s)var n='<span class="alsp-map-marker-icon fa '+s+'" style="color: '+i+';"></span>',r="fa-map-marker";else n="",r="fa-map-marker-empty";o=new RichMarker({position:e.point,map:alsp_map_backend,flat:!0,draggable:!0,height:40,content:'<div class="'+r+'" style="background: '+i+' none repeat scroll 0 0;">'+n+"</div>"});alsp_markersArray_backend.push(o),google.maps.event.addListener(o,"position_changed",function(a){var t=o.getPosition();if(void 0!==t){e.index;$(".alsp-manual-coords:eq("+e.index+")").attr("checked",!0),$(".alsp-manual-coords:eq("+e.index+")").parents(".alsp-manual-coords-wrapper").find(".alsp-manual-coords-block").show(200),$(".alsp-map-coords-1:eq("+e.index+")").val(t.lat()),$(".alsp-map-coords-2:eq("+e.index+")").val(t.lng())}})}}}(jQuery),function($){"use strict";function alsp_drawFreeHandPolygon(e){var a=new google.maps.Polyline({map:alsp_maps[e],clickable:!1,strokeColor:"#AA2143",strokeWeight:2,zIndex:1e3}),t=google.maps.event.addListener(alsp_maps[e],"mousemove",function(e){a.getPath().push(e.latLng)});google.maps.event.addListenerOnce(alsp_maps[e],"mouseup",function(o){google.maps.event.removeListener(t);var s=a.getPath();a.setMap(null);var i,n=s.b,r=alsp_GDouglasPeucker(n,50),l=[];for(i in r)l.push({lat:r[i].lat(),lng:r[i].lng()});if(l.length){alsp_sendGeoPolyAJAX(e,l);var p={map:alsp_maps[e],fillColor:"#0099FF",fillOpacity:.3,strokeColor:"#AA2143",strokeWeight:1,clickable:!1,zIndex:1,path:r,editable:!1};alsp_polygons[e]=new google.maps.Polygon(p)}var _=$(alsp_maps[e].getDiv()).find(".alsp-map-draw").get(0);_.drawing_state=0,window.removeEventListener("touchmove",alsp_stop_touchmove_listener,{passive:!1}),alsp_maps[e].setOptions({draggableCursor:""}),$(_).removeClass("btn-active"),alsp_disableDrawingMode(e),google.maps.event.clearListeners(alsp_maps[e].getDiv(),"mousedown");var d=$(alsp_maps[e].getDiv()).find(".alsp-map-edit").get(0);$(d).removeAttr("disabled")})}function alsp_enableDrawingMode(e){$(alsp_maps[e].getDiv()).find(".alsp-map-custom-controls").hide(),!alsp_isSidebarOpen(e)&&$("#alsp-map-search-wrapper-"+e).length&&$("#alsp-map-search-wrapper-"+e).hide(),alsp_maps[e].setOptions({draggable:!1,scrollwheel:!1,streetViewControl:!1})}function alsp_disableDrawingMode(e){$(alsp_maps[e].getDiv()).find(".alsp-map-custom-controls").show(),$("#alsp-map-search-wrapper-"+e).length&&$("#alsp-map-search-wrapper-"+e).show();var a=alsp_get_map_markers_attrs_array(e),t=a.enable_wheel_zoom;if(!a.enable_dragging_touchscreens&&"ontouchstart"in document.documentElement)o=!1;else var o=!0;alsp_maps[e].setOptions({draggable:o,scrollwheel:t,streetViewControl:!0})}function alsp_load_maps(){for(var e=0;e<alsp_map_markers_attrs_array.length;e++)void 0===alsp_maps[alsp_map_markers_attrs_array[e].map_id]&&alsp_load_map(e);alsp_show_on_map_links(),alsp_geolocatePosition()}function alsp_positionCustomControls(e,a){var t=alsp_maps[e].getDiv();$(t).parent().hasClass("alsp-map-search-input-enabled")&&$("#alsp-maps-canvas-wrapper-"+e).width()<=620?$(a).addClass("alsp-map-custom-controls-lower"):$(a).removeClass("alsp-map-custom-controls-lower")}function alsp_load_map(i){var map_id=alsp_map_markers_attrs_array[i].map_id,markers_array=alsp_map_markers_attrs_array[i].markers_array,enable_radius_circle=alsp_map_markers_attrs_array[i].enable_radius_circle,enable_clusters=alsp_map_markers_attrs_array[i].enable_clusters,show_summary_button=alsp_map_markers_attrs_array[i].show_summary_button,map_style=alsp_map_markers_attrs_array[i].map_style,draw_panel=alsp_map_markers_attrs_array[i].draw_panel,show_readmore_button=alsp_map_markers_attrs_array[i].show_readmore_button,enable_full_screen=alsp_map_markers_attrs_array[i].enable_full_screen,enable_wheel_zoom=alsp_map_markers_attrs_array[i].enable_wheel_zoom,enable_dragging_touchscreens=alsp_map_markers_attrs_array[i].enable_dragging_touchscreens,show_directions=alsp_map_markers_attrs_array[i].show_directions,map_attrs=alsp_map_markers_attrs_array[i].map_attrs;if(document.getElementById("alsp-maps-canvas-"+map_id)){if(void 0===alsp_fullScreens[map_id]||!alsp_fullScreens[map_id]){if(alsp_js_objects.is_rtl)var cposition=google.maps.ControlPosition.LEFT_TOP;else var cposition=google.maps.ControlPosition.RIGHT_TOP;if(!enable_dragging_touchscreens&&"ontouchstart"in document.documentElement)var enable_dragging=!1;else var enable_dragging=!0;var mapOptions={zoom:1,draggable:enable_dragging,scrollwheel:enable_wheel_zoom,disableDoubleClickZoom:!0,streetViewControl:!0,streetViewControlOptions:{position:cposition},mapTypeControl:!1,zoomControl:!1,panControl:!1,scaleControl:!1,fullscreenControl:!1},customControls;if(map_style&&(mapOptions.styles=eval(map_style)),alsp_maps[map_id]=new google.maps.Map(document.getElementById("alsp-maps-canvas-"+map_id),mapOptions),alsp_maps_attrs[map_id]=map_attrs,google.maps.event.addListenerOnce(alsp_maps[map_id],"idle",function(){void 0!==alsp_maps[map_id].controls[cposition].getAt(-2)&&alsp_maps[map_id].controls[cposition].removeAt(-2),(customControls=document.createElement("div")).index=-2,alsp_maps[map_id].controls[cposition].push(customControls),$(customControls).addClass("alsp-map-custom-controls"),$(customControls).html('<div class="btn-group"><button class="btn btn-primary alsp-map-btn-zoom-in"><span class="glyphicon glyphicon-plus"></span></button><button class="btn btn-primary alsp-map-btn-zoom-out"><span class="glyphicon glyphicon-minus"></span></button></div> <div class="btn-group"><button class="btn btn-primary alsp-map-btn-roadmap">'+alsp_maps[map_id].mapTypes.roadmap.name+'</button><button class="btn btn-primary alsp-map-btn-satellite">'+alsp_maps[map_id].mapTypes.satellite.name+"</button>"+(enable_full_screen?'<button class="btn btn-primary alsp-map-btn-fullscreen"><span class="glyphicon glyphicon-fullscreen"></span></button>':"")+"</div>"),alsp_positionCustomControls(map_id,customControls),google.maps.event.addListener(alsp_maps[map_id],"bounds_changed",function(){alsp_positionCustomControls(map_id,customControls)}),google.maps.event.addDomListener($(customControls).find(".alsp-map-btn-zoom-in").get(0),"click",function(){alsp_maps[map_id].setZoom(alsp_maps[map_id].getZoom()+1)}),google.maps.event.addDomListener($(customControls).find(".alsp-map-btn-zoom-out").get(0),"click",function(){alsp_maps[map_id].setZoom(alsp_maps[map_id].getZoom()-1)}),google.maps.event.addDomListener($(customControls).find(".alsp-map-btn-roadmap").get(0),"click",function(){alsp_maps[map_id].setMapTypeId(google.maps.MapTypeId.ROADMAP)}),google.maps.event.addDomListener($(customControls).find(".alsp-map-btn-satellite").get(0),"click",function(){alsp_maps[map_id].setMapTypeId(google.maps.MapTypeId.HYBRID)});var e=alsp_maps[map_id].getDiv(),a=$(e).parent().parent(),t=e.style;e.runtimeStyle&&(t=e.runtimeStyle);var o=t.position,s=t.width,i=t.height;""===s&&(s=e.style.width),""===i&&(i=e.style.height);var n=t.top,r=t.left,l=t.zIndex,p=document.body.style;document.body.runtimeStyle&&(p=document.body.runtimeStyle);var _=p.overflow,d=!1;function c(){$("#alsp-map-placeholder-"+map_id).after(a),$("#alsp-map-placeholder-"+map_id).detach();var t=alsp_maps[map_id].getCenter();e.style.position=""===o?"relative":o,e.style.width=s,e.style.height=i,e.style.top=n,e.style.left=r,e.style.zIndex=l,$(e).parent(".alsp-maps-canvas-wrapper").zIndex(l).css("overflow","hidden"),document.body.style.overflow=_,$(customControls).find(".alsp-map-btn-fullscreen span").removeClass("glyphicon-resize-small"),$(customControls).find(".alsp-map-btn-fullscreen span").addClass("glyphicon-fullscreen"),alsp_callMapResize(map_id),alsp_setMapCenter(map_id,t),$(["#alsp-map-search-wrapper-"+map_id,"#alsp-map-search-panel-wrapper-"+map_id,"#alsp-map-sidebar-toggle-container-"+map_id]).each(function(){$(this).length&&$(this).css("position","absolute").zIndex(1)}),$(window).trigger("resize"),$(".alsp-map-listings-panel").length&&$(".alsp-map-listings-panel").getNiceScroll().resize()}if(enable_full_screen){google.maps.event.addDomListener($(customControls).find(".alsp-map-btn-fullscreen").get(0),"click",function(){void 0!==alsp_fullScreens[map_id]&&alsp_fullScreens[map_id]?($("#alsp-maps-canvas-wrapper-"+map_id).removeClass("alsp-map-full-screen"),alsp_fullScreens[map_id]=!1,c()):($("#alsp-maps-canvas-wrapper-"+map_id).addClass("alsp-map-full-screen"),alsp_fullScreens[map_id]=!0,function(){a.after("<div id='alsp-map-placeholder-"+map_id+"'></div>"),a.appendTo("body");var t=alsp_maps[map_id].getCenter();e.style.position="fixed",e.style.width="100%",e.style.height="100%",e.style.top="0",e.style.left="0",e.style.zIndex="100000",$(e).parent(".alsp-maps-canvas-wrapper").zIndex(1e5).css("overflow","initial"),document.body.style.overflow="hidden",$(customControls).find(".alsp-map-btn-fullscreen span").removeClass("glyphicon-fullscreen"),$(customControls).find(".alsp-map-btn-fullscreen span").addClass("glyphicon-resize-small"),alsp_callMapResize(map_id),alsp_setMapCenter(map_id,t),$(["#alsp-map-search-wrapper-"+map_id,"#alsp-map-search-panel-wrapper-"+map_id,"#alsp-map-sidebar-toggle-container-"+map_id]).each(function(){$(this).length&&$(this).css("position","fixed").zIndex(100001)}),$(window).trigger("resize"),$(".alsp-map-listings-panel").length&&$(".alsp-map-listings-panel").getNiceScroll().resize()}())});var m=alsp_maps[map_id].getStreetView();google.maps.event.addListener(m,"visible_changed",function(){d=!!this.getVisible(),$("#alsp-map-search-wrapper-"+map_id).length&&(d?$("#alsp-map-search-wrapper-"+map_id).hide():$("#alsp-map-search-wrapper-"+map_id).show())}),$(document).on("keyup",function(e){void 0!==alsp_fullScreens[map_id]&&alsp_fullScreens[map_id]&&27==e.keyCode&&!d&&($("#alsp-maps-canvas-wrapper-"+map_id).removeClass("alsp-map-full-screen"),alsp_fullScreens[map_id]=!1,c())})}}),draw_panel){void 0!==alsp_maps[map_id].controls[cposition].getAt(-1)&&alsp_maps[map_id].controls[cposition].removeAt(-1);var drawPanel=document.createElement("div");drawPanel.index=-1,alsp_maps[map_id].controls[cposition].push(drawPanel),$(drawPanel).addClass("alsp-map-draw-panel");var drawButton=document.createElement("button");$(drawButton).addClass("btn btn-primary alsp-map-draw").attr("title",alsp_maps_objects.draw_area_button).html('<span class="glyphicon glyphicon-pencil"></span>'),drawPanel.appendChild(drawButton),drawButton.map_id=map_id,drawButton.drawing_state=0,$(drawButton).on("click",function(e){var a=drawButton.map_id;if(0==this.drawing_state){this.drawing_state=1,window.addEventListener("touchmove",alsp_stop_touchmove_listener,{passive:!1}),alsp_clearMarkers(a),alsp_removeShapes(a),alsp_enableDrawingMode(a);var t=$(alsp_maps[a].getDiv()).find(".alsp-map-edit").get(0);$(t).attr("disabled","disabled"),(o=alsp_get_map_markers_attrs_array(a))&&(o.map_attrs.drawing_state=1,google.maps.event.clearListeners(alsp_maps[a],"idle"),delete o.map_attrs.ajax_loading),alsp_maps[a].setOptions({draggableCursor:"crosshair"}),$(this).toggleClass("btn-active"),alsp_maps[a].getDiv().map_id=a,$("body").hasClass("alsp-touch")?alsp_drawFreeHandPolygon(this.map_id):(google.maps.event.clearListeners(alsp_maps[a].getDiv(),"mousedown"),google.maps.event.addDomListener(alsp_maps[a].getDiv(),"mousedown",function(e){var a=e.target;do{if($(a).hasClass("alsp-map-draw-panel"))return}while(a=a.parentNode);alsp_drawFreeHandPolygon(this.map_id)}))}else if(1==this.drawing_state){var o;this.drawing_state=0,window.removeEventListener("touchmove",alsp_stop_touchmove_listener,{passive:!1}),alsp_disableDrawingMode(a),alsp_maps[a].setOptions({draggableCursor:""}),$(this).toggleClass("btn-active"),google.maps.event.clearListeners(alsp_maps[a].getDiv(),"mousedown"),(o=alsp_get_map_markers_attrs_array(a))&&(o.map_attrs.drawing_state=0,void 0!==alsp_get_original_map_markers_attrs_array(a).map_attrs.ajax_loading&&1==alsp_get_original_map_markers_attrs_array(a).map_attrs.ajax_loading&&(o.map_attrs.ajax_loading=1,google.maps.event.addListener(alsp_maps[a],"idle",function(){alsp_setAjaxMarkers(alsp_maps[a],a)})))}});var editButton=document.createElement("button");$(editButton).addClass("btn btn-primary alsp-map-edit").attr("title",alsp_maps_objects.edit_area_button).html('<span class="glyphicon glyphicon-edit"></span>').attr("disabled","disabled"),drawPanel.appendChild(editButton),editButton.map_id=map_id,editButton.editing_state=0,$(editButton).on("click",function(e){var a=editButton.map_id;if(0==this.editing_state)this.editing_state=1,$(this).toggleClass("btn-active"),$(this).attr("title",alsp_maps_objects.apply_area_button),void 0!==alsp_polygons[a]&&alsp_polygons[a].setOptions({editable:!0});else if(1==this.editing_state&&(this.editing_state=0,$(this).toggleClass("btn-active"),$(this).attr("title",alsp_maps_objects.edit_area_button),void 0!==alsp_polygons[a])){alsp_polygons[a].setOptions({editable:!1});var t,o=alsp_polygons[a].getPath().b,s=[];for(t in o)s.push({lat:o[t].lat(),lng:o[t].lng()});alsp_sendGeoPolyAJAX(a,s)}});var reloadButton=document.createElement("button");$(reloadButton).addClass("btn btn-primary alsp-map-reload").attr("title",alsp_maps_objects.reload_map_button).html('<span class="glyphicon glyphicon-refresh"></span>'),drawPanel.appendChild(reloadButton),reloadButton.map_id=map_id,$(reloadButton).on("click",function(e){for(var a=reloadButton.map_id,t=0;t<alsp_map_markers_attrs_array.length;t++)if(alsp_map_markers_attrs_array[t].map_id==a){alsp_map_markers_attrs_array[t]=JSON.parse(JSON.stringify(_alsp_map_markers_attrs_array[t])),window.removeEventListener("touchmove",alsp_stop_touchmove_listener,{passive:!1});var o=$(alsp_maps[a].getDiv()).find(".alsp-map-edit").get(0);if($(o).removeClass("btn-active"),$(o).find(".alsp-map-edit-label").text(alsp_maps_objects.edit_area_button),$(o).attr("disabled","disabled"),alsp_clearMarkers(a),alsp_removeShapes(a),alsp_load_map(t),google.maps.event.trigger(alsp_maps[a],"idle"),alsp_global_markers_array[a].length){for(var s=[],i=new google.maps.LatLngBounds,n=0;n<alsp_global_markers_array[a].length;n++){var r=alsp_global_markers_array[a][n];alsp_extendBounds(i,alsp_getMarkerPosition(r)),s.push(r)}alsp_mapFitBounds(a,i);var l=alsp_map_markers_attrs_array[t].map_attrs;alsp_setMapZoomCenter(a,l,s)}break}}),alsp_maps_objects.enable_my_location_button&&google.maps.event.addListenerOnce(alsp_maps[map_id],"tilesloaded",function(){var e=document.createElement("button");$(e).addClass("btn btn-primary alsp-map-location").attr("title",alsp_maps_objects.my_location_button).html('<span class="glyphicon glyphicon-screenshot"></span>'),drawPanel.appendChild(e),e.map_id=map_id,$(e).on("click",function(a){var t=e.map_id;navigator.geolocation&&navigator.geolocation.getCurrentPosition(function(e){var a=e.coords.latitude,o=e.coords.longitude;alsp_maps[t].setCenter(new google.maps.LatLng(a,o))},function(e){},{timeout:1e4})})})}}alsp_global_markers_array[map_id]=[],alsp_global_locations_array[map_id]=[];var bounds=new google.maps.LatLngBounds;if(markers_array.length){if(void 0!==map_attrs.ajax_markers_loading&&1==map_attrs.ajax_markers_loading)var is_ajax_markers=!0;else var is_ajax_markers=!1;for(var markers=[],j=0;j<markers_array.length;j++){var map_coords_1=markers_array[j][1],map_coords_2=markers_array[j][2];if($.isNumeric(map_coords_1)&&$.isNumeric(map_coords_2)){var point=new google.maps.LatLng(map_coords_1,map_coords_2);bounds.extend(point);var location_obj=new alsp_glocation(markers_array[j][0],point,markers_array[j][3],markers_array[j][4],markers_array[j][6],markers_array[j][7],markers_array[j][8],markers_array[j][9],markers_array[j][10],markers_array[j][11],show_summary_button,show_readmore_button,map_id,is_ajax_markers),marker=location_obj.alsp_placeMarker(map_id);markers.push(marker),alsp_global_locations_array[map_id].push(location_obj)}}if(!(void 0!==map_attrs.start_latitude&&map_attrs.start_latitude&&void 0!==map_attrs.start_longitude&&map_attrs.start_longitude)&!(void 0!==map_attrs.start_address&&map_attrs.start_address)&&alsp_mapFitBounds(map_id,bounds),alsp_setClusters(enable_clusters,map_id,markers),enable_radius_circle&&void 0!==window["radius_params_"+map_id]){var radius_params=window["radius_params_"+map_id],map_radius=parseFloat(radius_params.radius_value);alsp_draw_radius(radius_params,map_radius,map_id)}}alsp_setMapZoomCenter(map_id,map_attrs,markers_array)}}function alsp_setMapAjaxListener(e,a,t){t=void 0!==t?t:null;google.maps.event.addListener(e,"idle",function(){alsp_setAjaxMarkers(e,a,t)})}function alsp_geocodeStartAddress(e,a,t){var o=e.start_address;alsp_geocodeAddress(o,function(o,s,i){1==o&&(alsp_setMapCenter(a,new google.maps.LatLng(s,i)),alsp_setMapZoom(a,t),void 0!==e.ajax_loading&&1==e.ajax_loading&&alsp_setMapAjaxListener(alsp_maps[a],a))})}function alsp_geolocatePosition(){if(navigator.geolocation){var e=[];for(var a in alsp_maps_attrs)void 0!==alsp_maps_attrs[a].geolocation&&1==alsp_maps_attrs[a].geolocation&&e.push({map:alsp_maps[a],map_id:a});e.length&&navigator.geolocation.getCurrentPosition(function(a){var t=a.coords.latitude,o=a.coords.longitude;for(var s in e){var i=e[s].map_id;alsp_setMapCenter(i,new google.maps.LatLng(t,o)),void 0!==alsp_maps_attrs[i].start_zoom&&alsp_maps_attrs[i].start_zoom>0&&alsp_setMapZoom(i,alsp_maps_attrs[i].start_zoom);for(var n=0;n<alsp_map_markers_attrs_array.length;n++)alsp_map_markers_attrs_array[n].map_id==i&&(alsp_map_markers_attrs_array[n].map_attrs.start_latitude=t,alsp_map_markers_attrs_array[n].map_attrs.start_longitude=o)}},function(e){},{timeout:1e4})}}function alsp_project(e){var a=Math.sin(e.lat()*Math.PI/180);return a=Math.min(Math.max(a,-.9999),.9999),new google.maps.Point(256*(.5+e.lng()/360),256*(.5-Math.log((1+a)/(1-a))/(4*Math.PI)))}window.alsp_buildPoint=function(e,a){return new google.maps.LatLng(e,a)},window.alsp_buildBounds=function(){return new google.maps.LatLngBounds},window.alsp_extendBounds=function(e,a){e.extend(a)},window.alsp_mapFitBounds=function(e,a){alsp_maps[e].fitBounds(a)},window.alsp_getMarkerPosition=function(e){return e.position},window.alsp_closeInfoWindow=function(e){void 0!==alsp_infoWindows[e]&&alsp_infoWindows[e].close()},window.alsp_setAjaxMarkersListener=function(e){google.maps.event.addListener(alsp_maps[e],"idle",function(){alsp_setAjaxMarkers(alsp_maps[e],e)})},window.alsp_geocodeAddress=function(e,a){void 0!==google.maps&&void 0!==google.maps.places?(new google.maps.Geocoder).geocode({address:e},function(e,t){if(t==google.maps.GeocoderStatus.OK)var o=!0,s=e[0].geometry.location.lat(),i=e[0].geometry.location.lng();else o=!1;a(o,s,i)}):a(!1,0,0)},window.alsp_callMapResize=function(e){google.maps.event.trigger(alsp_maps[e],"resize")},window.alsp_setMapCenter=function(e,a){alsp_maps[e].setCenter(a)},window.alsp_setMapZoom=function(e,a){var t=google.maps.event.addListener(alsp_maps[e],"idle",function(){alsp_maps[e].setZoom(parseInt(a)),google.maps.event.removeListener(t)})},window.alsp_autocompleteService=function(e,a,t,o,s){if("0"!=a)var i={input:e,componentRestrictions:{country:a}};else i={input:e};(new google.maps.places.AutocompleteService).getPlacePredictions(i,function(e,a){var i=[];$.map(e,function(e,a){var t={label:e.terms[0].value,value:e.description,name:e.terms[0].value,sublabel:e.structured_formatting.secondary_text};i.push(t)}),s(i,t,o)})},window.alsp_setMapZoomCenter=function(e,a,t){if(void 0!==a.start_zoom&&a.start_zoom>0)var o=a.start_zoom;else if(1==t.length)o=t[0][5];else if(t.length>1)o=!1;else o=2;if(void 0!==a.start_latitude&&a.start_latitude&&void 0!==a.start_longitude&&a.start_longitude){var s=a.start_latitude,i=a.start_longitude;alsp_setMapCenter(e,new google.maps.LatLng(s,i)),0==o&&(o=12),alsp_maps[e].setZoom(parseInt(o)),void 0!==a.ajax_loading&&1==a.ajax_loading&&alsp_setMapAjaxListener(alsp_maps[e],e)}else void 0!==a.start_address&&a.start_address?alsp_geocodeStartAddress(a,e,o):1==t.length?alsp_setMapZoom(e,o):o&&(alsp_setMapCenter(e,new google.maps.LatLng(34,0)),alsp_setMapZoom(e,o))},window.alsp_show_on_map_links=function(){$(".alsp-show-on-map").each(function(){var e=$(this).data("location-id"),a=!1;for(var t in alsp_maps)if(void 0!==alsp_global_locations_array[t])for(var o=0;o<alsp_global_locations_array[t].length;o++)"object"==typeof alsp_global_locations_array[t][o]&&e==alsp_global_locations_array[t][o].id&&(a=!0);a?$(this).parent(".alsp-listing-figcaption-option").show():($(this).css({cursor:"auto"}),$(this).hasClass("btn")&&$(this).hide())})},window.alsp_load_maps_api=function(){if($(document).trigger("alsp_google_maps_api_loaded"),"undefined"!=typeof alsp_map_markers_attrs_array&&alsp_map_markers_attrs_array.length&&(_alsp_map_markers_attrs_array=JSON.parse(JSON.stringify(alsp_map_markers_attrs_array)),google.maps.event.addDomListener(window,"load",alsp_load_maps())),alsp_load_ajax_initial_elements(),$(".alsp-field-autocomplete").each(function(){if(google.maps&&google.maps.places){if("0"!=alsp_maps_objects.address_autocomplete_code)var e={componentRestrictions:{country:alsp_maps_objects.address_autocomplete_code}};else e={};new google.maps.places.Autocomplete(this,e)}}),$(".direction_button").length){var map_id=$(".direction_button").attr("id").replace("get_direction_button_",""),directionsService=new google.maps.DirectionsService,directionsDisplay=new google.maps.DirectionsRenderer({map:alsp_maps[map_id]});directionsDisplay.setPanel(document.getElementById("route_"+map_id))}$(".direction_button").click(function(){map_id=$(".direction_button").attr("id").replace("get_direction_button_","");var e={origin:$("#from_direction_"+map_id).val(),destination:$(".select_direction_"+map_id+":checked").val(),travelMode:google.maps.DirectionsTravelMode.DRIVING};directionsService.route(e,function(e,a){a==google.maps.DirectionsStatus.OK?directionsDisplay.setDirections(e):alsp_handleDirectionsErrors(a)})}),google.maps.Map.prototype.panToWithOffset=function(e,a,t){var o=this,s=new google.maps.OverlayView;s.onAdd=function(){var s=this.getProjection(),i=s.fromLatLngToContainerPixel(e);i.x=i.x+a,i.y=i.y+t,o.panTo(s.fromContainerPixelToLatLng(i))},s.draw=function(){},s.setMap(this)},$("body").on("click",".alsp-show-on-map",function(){var location_id=$(this).data("location-id");for(var map_id in alsp_maps)if(void 0!==alsp_global_locations_array[map_id])for(var i=0;i<alsp_global_locations_array[map_id].length;i++)if("object"==typeof alsp_global_locations_array[map_id][i]&&location_id==alsp_global_locations_array[map_id][i].id){var location_obj=alsp_global_locations_array[map_id][i];if(location_obj.is_ajax_markers){alsp_ajax_loader_target_show($("#alsp-maps-canvas-"+map_id));var post_data={location_id:location_obj.id,action:"alsp_get_map_marker_info"};$.ajax({type:"POST",url:alsp_js_objects.ajaxurl,data:eval(post_data),map_id:map_id,dataType:"json",success:function(e){var a=e,t=a[1],o=a[2];if($.isNumeric(t)&&$.isNumeric(o)){var s=new google.maps.LatLng(t,o);alsp_showInfoWindow(new alsp_glocation(a[0],s,a[3],a[4],a[6],a[7],a[8],a[9],a[10],a[11],location_obj.show_summary_button,location_obj.show_readmore_button,this.map_id,!0),location_obj.marker,this.map_id),google.maps.event.addListenerOnce(alsp_maps[map_id],"idle",function(){alsp_maps[map_id].panToWithOffset(s,0,-150)})}},complete:function(){alsp_ajax_loader_target_hide("alsp-maps-canvas-"+this.map_id)}})}else alsp_showInfoWindow(location_obj,location_obj.marker,map_id),google.maps.event.addListenerOnce(alsp_maps[map_id],"idle",function(){alsp_maps[map_id].panToWithOffset(location_obj.marker.position,0,-150)})}})},document.addEventListener("DOMContentLoaded",function(){if("undefined"!=typeof google&&void 0!==google.maps||alsp_maps_objects.notinclude_maps_api)alsp_3rd_party_maps_plugin=!0,window[alsp_maps_callback.callback]();else{var e=document.createElement("script");e.type="text/javascript";var a="",t="";alsp_maps_objects.google_api_key&&(a="&key="+alsp_maps_objects.google_api_key),alsp_js_objects.lang&&(t="&language="+alsp_js_objects.lang),e.src="//maps.google.com/maps/api/js?libraries=places"+a+"&callback="+alsp_maps_callback.callback+t,document.body.appendChild(e)}}),window.alsp_setAjaxMarkers=function(e,a,t){var o=alsp_get_map_markers_attrs_array(a),s=o.map_attrs,i=o.enable_radius_circle,n=o.enable_clusters,r=o.show_summary_button,l=o.show_readmore_button,p=(t=void 0!==t?t:null,"");if(void 0!==s.address&&s.address)p=s.address;else if(void 0!==s.location_id_text&&s.location_id_text)p=s.location_id_text;p&&(void 0!==alsp_searchAddresses[a]&&alsp_searchAddresses[a]==p||((new google.maps.Geocoder).geocode({address:p},function(o,s){if(s==google.maps.GeocoderStatus.OK)var i=o[0].geometry.location.lat(),n=o[0].geometry.location.lng();e.panTo(new google.maps.LatLng(i,n)),t&&alsp_delete_iloader_from_element(t),alsp_setAjaxMarkers(e,a)}),alsp_searchAddresses[a]=p));var _=e.getBounds();if(!_)return!1;var d=_.getSouthWest(),c=_.getNorthEast();if(void 0!==s.swLat&&void 0!==s.swLng&&void 0!==s.neLat&&void 0!==s.neLng){var m=new google.maps.LatLngBounds,g=new google.maps.LatLng(s.swLat,s.swLng),h=new google.maps.LatLng(s.neLat,s.neLng);m.extend(g),m.extend(h);var u=1<<e.getZoom(),f=alsp_project(g),v=alsp_project(d);if(m.contains(d)&&m.contains(c)||140>Math.abs(Math.floor(f.x*u)-Math.floor(v.x*u))&&140>Math.abs(Math.floor(f.y*u)-Math.floor(v.y*u)))return!1}s.swLat=d.lat(),s.swLng=d.lng(),s.neLat=c.lat(),s.neLng=c.lng(),alsp_ajax_loader_target_show($("#alsp-maps-canvas-"+a));var y,b={};for(var w in s)"start_latitude"!=w&&"start_longitude"!=w&&(b[w]=s[w]);b.action="alsp_get_map_markers",b.hash=a,(y=alsp_get_controller_args_array(a))?(b.hide_order=y.hide_order,b.hide_count=y.hide_count,b.hide_paginator=y.hide_paginator,b.show_views_switcher=y.show_views_switcher,b.listings_view_type=y.listings_view_type,b.listings_view_grid_columns=y.listings_view_grid_columns,b.listing_thumb_width=y.listing_thumb_width,b.wrap_logo_list_view=y.wrap_logo_list_view,b.logo_animation_effect=y.logo_animation_effect,b.grid_view_logo_ratio=y.grid_view_logo_ratio,b.scrolling_paginator=y.scrolling_paginator,b.perpage=y.perpage,b.onepage=y.onepage,b.order=y.order,b.order_by=y.order_by,b.base_url=y.base_url,alsp_ajax_loader_target_show($("#alsp-controller-"+a))):b.without_listings=1,$("#alsp-map-listings-panel-"+a).length&&(b.map_listings=1,alsp_ajax_loader_target_show($("#alsp-map-search-panel-wrapper-"+a))),$.ajax({type:"POST",url:alsp_js_objects.ajaxurl,data:b,dataType:"json",success:function(e){if(e){var t=e.hash;if(e.html)$("#alsp-controller-"+t).replaceWith(e.html),alsp_ajax_loader_target_hide("alsp-controller-"+t);var o=$("#alsp-map-listings-panel-"+t);if(o.length&&(o.html(e.map_listings),alsp_ajax_loader_target_hide("alsp-map-search-panel-wrapper-"+t)),alsp_clearMarkers(a),alsp_removeShapes(a),void 0!==s.ajax_markers_loading&&1==s.ajax_markers_loading)var p=!0;else p=!1;var _=e.map_markers;alsp_global_locations_array[a]=[];for(var d=0;d<_.length;d++){var c=_[d][1],m=_[d][2];if($.isNumeric(c)&&$.isNumeric(m)){var g=new google.maps.LatLng(c,m),h=new alsp_glocation(_[d][0],g,_[d][3],_[d][4],_[d][6],_[d][7],_[d][8],_[d][9],_[d][10],_[d][11],r,l,a,p);h.alsp_placeMarker(a);alsp_global_locations_array[a].push(h)}}if(alsp_setClusters(n,a,alsp_global_markers_array[a]),i&&void 0!==e.radius_params){var u=e.radius_params,f=parseFloat(u.radius_value);alsp_draw_radius(u,f,t)}}},complete:alsp_completeAJAXSearchOnMap(a,t)})};var alsp_completeAJAXSearchOnMap=function(e,a){return function(){alsp_ajax_loader_target_hide("alsp-controller-"+e),alsp_ajax_loader_target_hide("alsp-maps-canvas-"+e),alsp_equalColumnsHeight(),a&&alsp_delete_iloader_from_element(a)}};function alsp_showInfoWindow(e,a,t){function o(e){e=e||{},google.maps.OverlayView.apply(this,arguments),this.content_=e.content||"",this.disableAutoPan_=e.disableAutoPan||!1,this.maxWidth_=e.maxWidth||0,this.pixelOffset_=e.pixelOffset||new google.maps.Size(0,0),this.position_=e.position||new google.maps.LatLng(0,0),this.zIndex_=e.zIndex||null,this.boxClass_=e.boxClass||"infoBox",this.boxStyle_=e.boxStyle||{},this.closeBoxMargin_=e.closeBoxMargin||"2px",this.closeBoxURL_=e.closeBoxURL||"http://www.google.com/intl/en_us/mapfiles/close.gif",""===e.closeBoxURL&&(this.closeBoxURL_=""),this.infoBoxClearance_=e.infoBoxClearance||new google.maps.Size(1,1),void 0===e.visible&&(e.visible=void 0===e.isHidden||!e.isHidden),this.isHidden_=!e.visible,this.alignBottom_=e.alignBottom||!1,this.pane_=e.pane||"floatPane",this.enableEventPropagation_=e.enableEventPropagation||!1,this.div_=null,this.closeListener_=null,this.moveListener_=null,this.contextListener_=null,this.eventListeners_=null,this.fixedWidthSet_=null}if(o.prototype=new google.maps.OverlayView,o.prototype.createInfoBoxDiv_=function(){var e,a,t,o=this,s=function(e){e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation()};if(!this.div_){if(this.div_=document.createElement("div"),this.setBoxStyle_(),void 0===this.content_.nodeType?this.div_.innerHTML=this.getCloseBoxImg_()+this.content_:(this.div_.innerHTML=this.getCloseBoxImg_(),this.div_.appendChild(this.content_)),this.getPanes()[this.pane_].appendChild(this.div_),this.addClickHandler_(),this.div_.style.width?this.fixedWidthSet_=!0:0!==this.maxWidth_&&this.div_.offsetWidth>this.maxWidth_?(this.div_.style.width=this.maxWidth_,this.div_.style.overflow="auto",this.fixedWidthSet_=!0):(t=this.getBoxWidths_(),this.div_.style.width=this.div_.offsetWidth-t.left-t.right+"px",this.fixedWidthSet_=!1),this.panBox_(this.disableAutoPan_),!this.enableEventPropagation_){for(this.eventListeners_=[],a=["mousedown","mouseover","mouseout","mouseup","click","dblclick","touchstart","touchend","touchmove"],e=0;e<a.length;e++)this.eventListeners_.push(google.maps.event.addDomListener(this.div_,a[e],s));this.eventListeners_.push(google.maps.event.addDomListener(this.div_,"mouseover",function(){this.style.cursor="default"}))}this.contextListener_=google.maps.event.addDomListener(this.div_,"contextmenu",function(e){e.returnValue=!1,e.preventDefault&&e.preventDefault(),o.enableEventPropagation_||s(e)}),google.maps.event.trigger(this,"domready")}},o.prototype.getCloseBoxImg_=function(){var e="";return""!==this.closeBoxURL_&&(e="<img",e+=" src='"+this.closeBoxURL_+"'",e+=" align=right",e+=" style='",e+=" position: relative;",e+=" cursor: pointer;",e+=" margin: "+this.closeBoxMargin_+";",e+="'>"),e},o.prototype.addClickHandler_=function(){var e;""!==this.closeBoxURL_?(e=this.div_.firstChild,this.closeListener_=google.maps.event.addDomListener(e,"click",this.getCloseClickHandler_())):this.closeListener_=null},o.prototype.getCloseClickHandler_=function(){var e=this;return function(a){a.cancelBubble=!0,a.stopPropagation&&a.stopPropagation(),google.maps.event.trigger(e,"closeclick"),e.close()}},o.prototype.panBox_=function(e){var a,t=0,o=0;if(!e&&(a=this.getMap())instanceof google.maps.Map){a.getBounds().contains(this.position_)||a.setCenter(this.position_),a.getBounds();var s=a.getDiv(),i=s.offsetWidth,n=s.offsetHeight,r=this.pixelOffset_.width,l=this.pixelOffset_.height,p=this.div_.offsetWidth,_=this.div_.offsetHeight,d=this.infoBoxClearance_.width,c=this.infoBoxClearance_.height,m=this.getProjection().fromLatLngToContainerPixel(this.position_);m.x<-r+d?t=m.x+r-d:m.x+p+r+d>i&&(t=m.x+p+r+d-i),this.alignBottom_?m.y<-l+c+_?o=m.y+l-c-_:m.y+l+c>n&&(o=m.y+l+c-n):m.y<-l+c?o=m.y+l-c:m.y+_+l+c>n&&(o=m.y+_+l+c-n),(0!==t||0!==o)&&(a.getCenter(),a.panBy(t,o))}},o.prototype.setBoxStyle_=function(){var e,a;if(this.div_){this.div_.className=this.boxClass_,this.div_.style.cssText="",a=this.boxStyle_;for(e in a)a.hasOwnProperty(e)&&(this.div_.style[e]=a[e]);this.div_.style.WebkitTransform="translateZ(0)",void 0!==this.div_.style.opacity&&""!==this.div_.style.opacity&&(this.div_.style.MsFilter='"progid:DXImageTransform.Microsoft.Alpha(Opacity='+100*this.div_.style.opacity+')"',this.div_.style.filter="alpha(opacity="+100*this.div_.style.opacity+")"),this.div_.style.position="absolute",this.div_.style.visibility="hidden",null!==this.zIndex_&&(this.div_.style.zIndex=this.zIndex_)}},o.prototype.getBoxWidths_=function(){var e,a={top:0,bottom:0,left:0,right:0},t=this.div_;return document.defaultView&&document.defaultView.getComputedStyle?(e=t.ownerDocument.defaultView.getComputedStyle(t,""))&&(a.top=parseInt(e.borderTopWidth,10)||0,a.bottom=parseInt(e.borderBottomWidth,10)||0,a.left=parseInt(e.borderLeftWidth,10)||0,a.right=parseInt(e.borderRightWidth,10)||0):document.documentElement.currentStyle&&t.currentStyle&&(a.top=parseInt(t.currentStyle.borderTopWidth,10)||0,a.bottom=parseInt(t.currentStyle.borderBottomWidth,10)||0,a.left=parseInt(t.currentStyle.borderLeftWidth,10)||0,a.right=parseInt(t.currentStyle.borderRightWidth,10)||0),a},o.prototype.onRemove=function(){this.div_&&(this.div_.parentNode.removeChild(this.div_),this.div_=null)},o.prototype.draw=function(){this.createInfoBoxDiv_();var e=this.getProjection().fromLatLngToDivPixel(this.position_);this.div_.style.left=e.x+this.pixelOffset_.width+"px",this.alignBottom_?this.div_.style.bottom=-(e.y+this.pixelOffset_.height)+"px":this.div_.style.top=e.y+this.pixelOffset_.height+"px",this.div_.style.visibility=this.isHidden_?"hidden":"visible"},o.prototype.setOptions=function(e){void 0!==e.boxClass&&(this.boxClass_=e.boxClass,this.setBoxStyle_()),void 0!==e.boxStyle&&(this.boxStyle_=e.boxStyle,this.setBoxStyle_()),void 0!==e.content&&this.setContent(e.content),void 0!==e.disableAutoPan&&(this.disableAutoPan_=e.disableAutoPan),void 0!==e.maxWidth&&(this.maxWidth_=e.maxWidth),void 0!==e.pixelOffset&&(this.pixelOffset_=e.pixelOffset),void 0!==e.alignBottom&&(this.alignBottom_=e.alignBottom),void 0!==e.position&&this.setPosition(e.position),void 0!==e.zIndex&&this.setZIndex(e.zIndex),void 0!==e.closeBoxMargin&&(this.closeBoxMargin_=e.closeBoxMargin),void 0!==e.closeBoxURL&&(this.closeBoxURL_=e.closeBoxURL),void 0!==e.infoBoxClearance&&(this.infoBoxClearance_=e.infoBoxClearance),void 0!==e.isHidden&&(this.isHidden_=e.isHidden),void 0!==e.visible&&(this.isHidden_=!e.visible),void 0!==e.enableEventPropagation&&(this.enableEventPropagation_=e.enableEventPropagation),this.div_&&this.draw()},o.prototype.setContent=function(e){this.content_=e,this.div_&&(this.closeListener_&&(google.maps.event.removeListener(this.closeListener_),this.closeListener_=null),this.fixedWidthSet_||(this.div_.style.width=""),void 0===e.nodeType?this.div_.innerHTML=this.getCloseBoxImg_()+e:(this.div_.innerHTML=this.getCloseBoxImg_(),this.div_.appendChild(e)),this.fixedWidthSet_||(this.div_.style.width=this.div_.offsetWidth+"px",void 0===e.nodeType?this.div_.innerHTML=this.getCloseBoxImg_()+e:(this.div_.innerHTML=this.getCloseBoxImg_(),this.div_.appendChild(e))),this.addClickHandler_()),google.maps.event.trigger(this,"content_changed")},o.prototype.setPosition=function(e){this.position_=e,this.div_&&this.draw(),google.maps.event.trigger(this,"position_changed")},o.prototype.setZIndex=function(e){this.zIndex_=e,this.div_&&(this.div_.style.zIndex=e),google.maps.event.trigger(this,"zindex_changed")},o.prototype.setVisible=function(e){this.isHidden_=!e,this.div_&&(this.div_.style.visibility=this.isHidden_?"hidden":"visible")},o.prototype.getContent=function(){return this.content_},o.prototype.getPosition=function(){return this.position_},o.prototype.getZIndex=function(){return this.zIndex_},o.prototype.getVisible=function(){return void 0!==this.getMap()&&null!==this.getMap()&&!this.isHidden_},o.prototype.show=function(){this.isHidden_=!1,this.div_&&(this.div_.style.visibility="visible")},o.prototype.hide=function(){this.isHidden_=!0,this.div_&&(this.div_.style.visibility="hidden")},o.prototype.open=function(e,a){var t=this;a&&(this.position_=a.getPosition(),this.moveListener_=google.maps.event.addListener(a,"position_changed",function(){t.setPosition(this.getPosition())})),this.setMap(e),this.div_&&this.panBox_()},o.prototype.close=function(){var e;if(this.closeListener_&&(google.maps.event.removeListener(this.closeListener_),this.closeListener_=null),this.eventListeners_){for(e=0;e<this.eventListeners_.length;e++)google.maps.event.removeListener(this.eventListeners_[e]);this.eventListeners_=null}this.moveListener_&&(google.maps.event.removeListener(this.moveListener_),this.moveListener_=null),this.contextListener_&&(google.maps.event.removeListener(this.contextListener_),this.contextListener_=null),this.setMap(null)},e.nofollow)var s='rel="nofollow"';else s="";var i='<div class="alsp-map-info-window">';if(i+='<div class="alsp-map-info-window-title">',e.listing_url&&e.show_readmore_button&&(i+='<a class="alsp-map-info-window-title-link" href="'+e.listing_url+'" '+s+">"),i+=e.listing_title,e.listing_url&&e.show_readmore_button&&(i+="</a>"),i+='<span class="alsp-close-info-window pacz-icon-close" onClick="alsp_infoWindows[&quot;'+t+'&quot;].close();"></span>',i+="</div>",e.listing_logo){if(i+='<div class="alsp-map-info-window-logo" style="'+alsp_maps_objects.infowindow_logo_width+"px;height:"+alsp_maps_objects.infowindow_logo_height+'px;overflow:hidden;">',e.listing_url&&e.show_readmore_button&&(i+='<a href="'+e.listing_url+'" '+s+">"),i+=e.listing_logo,e.listing_url&&e.show_readmore_button&&(i+="</a>"),e.show_summary_button&&$("#"+e.anchor).length||e.listing_url&&e.show_readmore_button){if(e.show_summary_button&&$("#"+e.anchor).length&&e.listing_url&&e.show_readmore_button)n="alsp-map-info-window-buttons";else var n="alsp-map-info-window-buttons-single";i+='<div class="'+n+' clearfix">',e.show_summary_button&&$("#"+e.anchor).length&&(i+='<a href="javascript:void(0);" class="btn btn-primary alsp-scroll-to-listing" onClick="alsp_scrollToListing(&quot;'+e.anchor+"&quot;, &quot;"+t+'&quot;);">'+alsp_maps_objects.alsp_map_info_window_button_summary+"</a>"),e.listing_url&&e.show_readmore_button&&(i+='<a href="'+e.listing_url+'" '+s+' class="btn btn-primary">'+alsp_maps_objects.alsp_map_info_window_button_readmore+"</a>"),i+="</div>"}i+="</div>"}if(i+='<div class="alsp-map-info-window-content clearfix">',e.content_fields)for(var r=0;r<e.content_fields.length;r++)e.content_fields[r]&&(i+='<div class="alsp-map-info-window-field">',alsp_maps_objects.alsp_map_content_fields_icons[r]&&(i+='<span class="alsp-map-field-icon '+alsp_maps_objects.alsp_map_content_fields_icons[r]+'"></span>'),i+=e.content_fields[r],i+="</div>");i+="</div>";var l=parseInt(alsp_maps_objects.infowindow_width)/2;i+='<div class="alsp-map-info-window-tongue"></div>';var p={content:i+="</div>",alignBottom:!0,disableAutoPan:!1,pixelOffset:new google.maps.Size(-l,parseInt(alsp_maps_objects.infowindow_offset)-24),zIndex:null,boxStyle:{width:alsp_maps_objects.infowindow_width+"px"},closeBoxURL:"",infoBoxClearance:new google.maps.Size(1,1),isHidden:!1,pane:"floatPane",enableEventPropagation:!1};void 0!==alsp_infoWindows[t]&&alsp_infoWindows[t].close(),alsp_infoWindows[t]=new o(p),alsp_infoWindows[t].open(alsp_maps[t],a),alsp_infoWindows[t].marker=a}function alsp_handleDirectionsErrors(e){e==google.maps.DirectionsStatus.NOT_FOUND?alert("No corresponding geographic location could be found for one of the specified addresses. This may be due to the fact that the address is relatively new, or it may be incorrect."):e==google.maps.DirectionsStatus.ZERO_RESULTS?alert("No route could be found between the origin and destination."):e==google.maps.DirectionsStatus.UNKNOWN_ERROR?alert("A directions request could not be processed due to a server error. The request may succeed if you try again."):e==google.maps.DirectionsStatus.REQUEST_DENIED?alert("The webpage is not allowed to use the directions service."):e==google.maps.DirectionsStatus.INVALID_REQUEST?alert("The provided DirectionsRequest was invalid."):e==google.maps.DirectionsStatus.OVER_QUERY_LIMIT?alert("The webpage has sent too many requests within the allowed time period."):alert("An unknown error occurred.")}window.alsp_draw_radius=function(e,a,t){"miles"==e.dimension&&(a*=1.609344);var o=e.map_coords_1,s=e.map_coords_2;$.isNumeric(o)&&$.isNumeric(s)&&(a*=1e3,alsp_drawCircles[t]=new google.maps.Circle({center:new google.maps.LatLng(o,s),radius:a,strokeColor:"#FF0000",strokeOpacity:.25,strokeWeight:1,fillColor:"#FF0000",fillOpacity:.1,map:alsp_maps[t]}),google.maps.event.addListener(alsp_drawCircles[t],"mouseup",function(e){alsp_dragended=!1}))},window.alsp_placeMarker=function(location,map_id){if("icons"!=alsp_maps_objects.map_markers_type){if(""!=alsp_maps_objects.global_map_icons_path){var re=/(?:\.([^.]+))?$/;if(location.map_icon_file&&void 0!==re.exec(alsp_maps_objects.global_map_icons_path+"icons/"+location.map_icon_file)[1])var icon_file=alsp_maps_objects.global_map_icons_path+"icons/"+location.map_icon_file;else var icon_file=alsp_maps_objects.global_map_icons_path+"blank.png";var customIcon={url:icon_file,size:new google.maps.Size(parseInt(alsp_maps_objects.marker_image_width),parseInt(alsp_maps_objects.marker_image_height)),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(parseInt(alsp_maps_objects.marker_image_anchor_x),parseInt(alsp_maps_objects.marker_image_anchor_y))},marker=new google.maps.Marker({position:location.point,map:alsp_maps[map_id],icon:customIcon,animation:google.maps.Animation.DROP})}else var marker=new google.maps.Marker({position:location.point,map:alsp_maps[map_id],animation:google.maps.Animation.DROP});alsp_dragended=!1}else{if(alsp_load_richtext(),location.map_icon_color)var map_marker_color=location.map_icon_color;else var map_marker_color=alsp_maps_objects.default_marker_color;if("string"==typeof location.map_icon_file&&-1!=location.map_icon_file.indexOf("fa-"))var map_marker_icon='<span class="alsp-map-marker-icon fa '+location.map_icon_file+'" style="color: '+map_marker_color+';"></span>',map_marker_class="alsp-map-marker";else if(alsp_maps_objects.default_marker_icon)var map_marker_icon='<span class="alsp-map-marker-icon fa '+alsp_maps_objects.default_marker_icon+'" style="color: '+map_marker_color+';"></span>',map_marker_class="alsp-map-marker";else var map_marker_icon="",map_marker_class="alsp-map-marker-empty";var marker=new RichMarker({position:location.point,map:alsp_maps[map_id],flat:!0,content:'<div class="'+map_marker_class+'" style="background: '+map_marker_color+' none repeat scroll 0 0;">'+map_marker_icon+"</div>"});alsp_dragended=!1,google.maps.event.addListener(alsp_maps[map_id],"dragend",function(e){alsp_dragended=!0}),google.maps.event.addListener(alsp_maps[map_id],"mouseup",function(e){alsp_dragended=!1})}return alsp_global_markers_array[map_id].push(marker),google.maps.event.addListener(marker,"click",function(){if(!alsp_dragended){var attrs_array=alsp_get_map_markers_attrs_array(map_id);if(attrs_array.center_map_onclick){var map_attrs=attrs_array.map_attrs;void 0!==map_attrs.ajax_loading&&0!=map_attrs.ajax_loading||alsp_maps[map_id].panTo(marker.getPosition())}if($("#alsp-map-listings-panel-"+map_id).length&&$("#alsp-map-listings-panel-"+map_id+" #post-"+location.id).length&&$("#alsp-map-listings-panel-"+map_id).animate({scrollTop:$("#alsp-map-listings-panel-"+map_id).scrollTop()+$("#alsp-map-listings-panel-"+map_id+" #post-"+location.id).position().top},"fast"),location.is_ajax_markers){alsp_ajax_loader_target_show($("#alsp-maps-canvas-"+map_id));var post_data={location_id:location.id,action:"alsp_get_map_marker_info"};$.ajax({type:"POST",url:alsp_js_objects.ajaxurl,data:eval(post_data),dataType:"json",success:function(e){var a=e,t=a[1],o=a[2];if($.isNumeric(t)&&$.isNumeric(o)){var s=new google.maps.LatLng(t,o);alsp_showInfoWindow(new alsp_glocation(a[0],s,a[3],a[4],a[6],a[7],a[8],a[9],a[10],a[11],location.show_summary_button,location.show_readmore_button,map_id,!0),marker,map_id)}},complete:function(){alsp_ajax_loader_target_hide("alsp-maps-canvas-"+map_id)}})}else alsp_showInfoWindow(location,marker,map_id)}}),marker},window.alsp_scrollToListing=function(e,a){var t=$("#"+e),o=0;void 0!==window["alsp_sticky_scroll_toppadding_"+a]&&(o=window["alsp_sticky_scroll_toppadding_"+a]),t.length&&$("html,body").animate({scrollTop:t.position().top-o},"fast")},window.alsp_setClusters=function(e,a,t){if(e&&"function"==typeof MarkerClusterer){var o=[];if(""!=alsp_maps_objects.global_map_icons_path)o=[{url:alsp_maps_objects.global_map_icons_path+"clusters/icon_cluster1.png",height:64,width:64},{url:alsp_maps_objects.global_map_icons_path+"clusters/icon_cluster2.png",height:74,width:74},{url:alsp_maps_objects.global_map_icons_path+"clusters/icon_cluster3.png",height:84,width:84},{url:alsp_maps_objects.global_map_icons_path+"clusters/icon_cluster4.png",height:94,width:94},{url:alsp_maps_objects.global_map_icons_path+"clusters/icon_cluster5.png",height:104,width:104}];var s={gridSize:40,styles:o};if(0!=t.length)for(var i=0;i<t.length;i++)for(var n=t[i].getPosition(),r=0;r<t.length;r++){var l=t[i].getPosition();if(l.equals(n)){var p=l.lat()+(Math.random()-.5)/8e3,_=l.lng()+(Math.random()-.5)/8e3;t[i].setPosition(new google.maps.LatLng(p,_))}}alsp_markerClusters[a]=new MarkerClusterer(alsp_maps[a],t,s)}},window.alsp_clearMarkers=function(e){if(void 0!==alsp_markerClusters[e]&&alsp_markerClusters[e].clearMarkers(),alsp_global_markers_array[e])for(var a=0;a<alsp_global_markers_array[e].length;a++)alsp_global_markers_array[e][a].setMap(null);alsp_global_markers_array[e]=[],alsp_global_locations_array[e]=[],alsp_closeInfoWindow(e)},window.alsp_removeShapes=function(e){void 0!==alsp_drawCircles[e]&&(google.maps.event.clearListeners(alsp_drawCircles[e],"mouseup"),alsp_drawCircles[e].setMap(null)),void 0!==alsp_polygons[e]&&alsp_polygons[e].setMap(null)},window.alsp_setZoomCenter=function(e){if("undefined"!=typeof google&&void 0!==google.maps){var a=e.getZoom(),t=e.getCenter();google.maps.event.trigger(e,"resize"),e.setZoom(a),e.setCenter(t)}},window.alsp_geocodeField=function(e,a){navigator.geolocation?navigator.geolocation.getCurrentPosition(function(a){var t=new google.maps.LatLng(a.coords.latitude,a.coords.longitude);(new google.maps.Geocoder).geocode({latLng:t},function(a,t){t==google.maps.GeocoderStatus.OK&&a[0]&&(e.val(a[0].formatted_address),e.trigger("change"))})},function(e){},{enableHighAccuracy:!0,timeout:1e4,maximumAge:0}):alert(a)}}(jQuery),function(){var e,a=null;function t(e){return function(a){this[e]=a}}function o(e){return function(){return this[e]}}function s(e,t,o){this.extend(s,google.maps.OverlayView),this.c=e,this.a=[],this.f=[],this.ca=[53,56,66,78,90],this.j=[],this.A=!1,o=o||{},this.g=o.gridSize||60,this.l=o.minimumClusterSize||2,this.J=o.maxZoom||a,this.j=o.styles||[],this.X=o.imagePath||this.Q,this.W=o.imageExtension||this.P,this.O=!0,void 0!=o.zoomOnClick&&(this.O=o.zoomOnClick),this.r=!1,void 0!=o.averageCenter&&(this.r=o.averageCenter),function(e){if(!e.j.length)for(var a,t=0;a=e.ca[t];t++)e.j.push({url:e.X+(t+1)+"."+e.W,height:a,width:a})}(this),this.setMap(e),this.K=this.c.getZoom();var i=this;google.maps.event.addListener(this.c,"zoom_changed",function(){var e=i.c.getZoom();i.K!=e&&(i.K=e,i.m())}),google.maps.event.addListener(this.c,"idle",function(){i.i()}),t&&t.length&&this.C(t,!1)}function i(e,a){a.s=!1,a.draggable&&google.maps.event.addListener(a,"dragend",function(){a.s=!1,e.L()}),e.a.push(a)}function n(e,t){var o=-1;if(e.a.indexOf)o=e.a.indexOf(t);else for(var s,i=0;s=e.a[i];i++)if(s==t){o=i;break}return-1!=o&&(t.setMap(a),e.a.splice(o,1),!0)}function r(e){if(e.A)for(var t,o=e.v(new google.maps.LatLngBounds(e.c.getBounds().getSouthWest(),e.c.getBounds().getNorthEast())),s=0;t=e.a[s];s++)if(!t.s&&o.contains(t.getPosition())){for(var i=e,n=4e4,r=a,p=0,_=void 0;_=i.f[p];p++){if(g=_.getCenter()){var d=t.getPosition();if(g&&d){var c=(d.lat()-g.lat())*Math.PI/180,m=(d.lng()-g.lng())*Math.PI/180,g=Math.sin(c/2)*Math.sin(c/2)+Math.cos(g.lat()*Math.PI/180)*Math.cos(d.lat()*Math.PI/180)*Math.sin(m/2)*Math.sin(m/2);g=12742*Math.atan2(Math.sqrt(g),Math.sqrt(1-g))}else g=0;g<n&&(n=g,r=_)}}r&&r.F.contains(t.getPosition())?r.q(t):((_=new l(i)).q(t),i.f.push(_))}}function l(e){this.k=e,this.c=e.getMap(),this.g=e.w(),this.l=e.l,this.r=e.r,this.d=a,this.a=[],this.F=a,this.n=new _(this,e.z(),e.w())}function p(e){e.F=e.k.v(new google.maps.LatLngBounds(e.d,e.d))}function _(e,t,o){e.k.extend(_,google.maps.OverlayView),this.j=t,this.fa=o||0,this.u=e,this.d=a,this.c=e.getMap(),this.B=this.b=a,this.t=!1,this.setMap(this.c)}function d(e,a){var t=e.getProjection().fromLatLngToDivPixel(a);return t.x-=parseInt(e.p/2,10),t.y-=parseInt(e.h/2,10),t}function c(e){e.b&&(e.b.style.display="none"),e.t=!1}function m(e,a){var t=[];return t.push("background-image:url('"+e.da+"');"),t.push("background-position:"+(e.D?e.D:"0 0")+";"),"object"==typeof e.e?("number"==typeof e.e[0]&&e.e[0]>0&&e.e[0]<e.h?t.push("height:"+(e.h-e.e[0])+"px; padding-top:"+e.e[0]+"px;"):t.push("height:"+e.h+"px; line-height:"+e.h+"px;"),"number"==typeof e.e[1]&&e.e[1]>0&&e.e[1]<e.p?t.push("width:"+(e.p-e.e[1])+"px; padding-left:"+e.e[1]+"px;"):t.push("width:"+e.p+"px; text-align:center;")):t.push("height:"+e.h+"px; line-height:"+e.h+"px; width:"+e.p+"px; text-align:center;"),t.push("cursor:pointer; top:"+a.y+"px; left:"+a.x+"px; color:"+(e.M?e.M:"black")+"; position:absolute; font-size:"+(e.N?e.N:11)+"px; font-family:Arial,sans-serif; font-weight:bold"),t.join("")}(e=s.prototype).Q="http://google-maps-utility-library-v3.googlecode.com/svn/trunk/markerclusterer/images/m",e.P="png",e.extend=function(e,a){return function(e){for(var a in e.prototype)this.prototype[a]=e.prototype[a];return this}.apply(e,[a])},e.onAdd=function(){this.A||(this.A=!0,r(this))},e.draw=function(){},e.S=function(){for(var e,a=this.o(),t=new google.maps.LatLngBounds,o=0;e=a[o];o++)t.extend(e.getPosition());this.c.fitBounds(t)},e.z=o("j"),e.o=o("a"),e.V=function(){return this.a.length},e.ba=t("J"),e.I=o("J"),e.G=function(e,a){for(var t=0,o=e.length,s=o;0!==s;)s=parseInt(s/10,10),t++;return{text:o,index:t=Math.min(t,a)}},e.$=t("G"),e.H=o("G"),e.C=function(e,a){for(var t,o=0;t=e[o];o++)i(this,t);a||this.i()},e.q=function(e,a){i(this,e),a||this.i()},e.Y=function(e,a){var t=n(this,e);return!(a||!t)&&(this.m(),this.i(),!0)},e.Z=function(e,a){for(var t,o=!1,s=0;t=e[s];s++)t=n(this,t),o=o||t;if(!a&&o)return this.m(),this.i(),!0},e.U=function(){return this.f.length},e.getMap=o("c"),e.setMap=t("c"),e.w=o("g"),e.aa=t("g"),e.v=function(e){var a=this.getProjection(),t=new google.maps.LatLng(e.getNorthEast().lat(),e.getNorthEast().lng()),o=new google.maps.LatLng(e.getSouthWest().lat(),e.getSouthWest().lng());return(t=a.fromLatLngToDivPixel(t)).x+=this.g,t.y-=this.g,(o=a.fromLatLngToDivPixel(o)).x-=this.g,o.y+=this.g,t=a.fromDivPixelToLatLng(t),a=a.fromDivPixelToLatLng(o),e.extend(t),e.extend(a),e},e.R=function(){this.m(!0),this.a=[]},e.m=function(e){for(var t,o=0;t=this.f[o];o++)t.remove();for(o=0;t=this.a[o];o++)t.s=!1,e&&t.setMap(a);this.f=[]},e.L=function(){var e=this.f.slice();this.f.length=0,this.m(),this.i(),window.setTimeout(function(){for(var a,t=0;a=e[t];t++)a.remove()},0)},e.i=function(){r(this)},(e=l.prototype).q=function(e){var t;e:if(this.a.indexOf)t=-1!=this.a.indexOf(e);else{t=0;for(var o;o=this.a[t];t++)if(o==e){t=!0;break e}t=!1}if(t)return!1;if(this.d?this.r&&(o=this.a.length+1,t=(this.d.lat()*(o-1)+e.getPosition().lat())/o,o=(this.d.lng()*(o-1)+e.getPosition().lng())/o,this.d=new google.maps.LatLng(t,o),p(this)):(this.d=e.getPosition(),p(this)),e.s=!0,this.a.push(e),(t=this.a.length)<this.l&&e.getMap()!=this.c&&e.setMap(this.c),t==this.l)for(o=0;o<t;o++)this.a[o].setMap(a);if(t>=this.l&&e.setMap(a),e=this.c.getZoom(),(t=this.k.I())&&e>t)for(e=0;t=this.a[e];e++)t.setMap(this.c);else this.a.length<this.l?c(this.n):(t=this.k.H()(this.a,this.k.z().length),this.n.setCenter(this.d),(e=this.n).B=t,e.ga=t.text,e.ea=t.index,e.b&&(e.b.innerHTML=t.text),t=Math.max(0,e.B.index-1),t=Math.min(e.j.length-1,t),t=e.j[t],e.da=t.url,e.h=t.height,e.p=t.width,e.M=t.textColor,e.e=t.anchor,e.N=t.textSize,e.D=t.backgroundPosition,this.n.show());return!0},e.getBounds=function(){for(var e,a=new google.maps.LatLngBounds(this.d,this.d),t=this.o(),o=0;e=t[o];o++)a.extend(e.getPosition());return a},e.remove=function(){this.n.remove(),this.a.length=0,delete this.a},e.T=function(){return this.a.length},e.o=o("a"),e.getCenter=o("d"),e.getMap=o("c"),(e=_.prototype).onAdd=function(){this.b=document.createElement("DIV"),this.t&&(this.b.style.cssText=m(this,d(this,this.d)),this.b.innerHTML=this.B.text),this.getPanes().overlayMouseTarget.appendChild(this.b);var e=this;google.maps.event.addDomListener(this.b,"click",function(){var a=e.u.k;google.maps.event.trigger(a,"clusterclick",e.u),a.O&&e.c.fitBounds(e.u.getBounds())})},e.draw=function(){if(this.t){var e=d(this,this.d);this.b.style.top=e.y+"px",this.b.style.left=e.x+"px"}},e.show=function(){this.b&&(this.b.style.cssText=m(this,d(this,this.d)),this.b.style.display=""),this.t=!0},e.remove=function(){this.setMap(a)},e.onRemove=function(){this.b&&this.b.parentNode&&(c(this),this.b.parentNode.removeChild(this.b),this.b=a)},e.setCenter=t("d"),window.MarkerClusterer=s,s.prototype.addMarker=s.prototype.q,s.prototype.addMarkers=s.prototype.C,s.prototype.clearMarkers=s.prototype.R,s.prototype.fitMapToMarkers=s.prototype.S,s.prototype.getCalculator=s.prototype.H,s.prototype.getGridSize=s.prototype.w,s.prototype.getExtendedBounds=s.prototype.v,s.prototype.getMap=s.prototype.getMap,s.prototype.getMarkers=s.prototype.o,s.prototype.getMaxZoom=s.prototype.I,s.prototype.getStyles=s.prototype.z,s.prototype.getTotalClusters=s.prototype.U,s.prototype.getTotalMarkers=s.prototype.V,s.prototype.redraw=s.prototype.i,s.prototype.removeMarker=s.prototype.Y,s.prototype.removeMarkers=s.prototype.Z,s.prototype.resetViewport=s.prototype.m,s.prototype.repaint=s.prototype.L,s.prototype.setCalculator=s.prototype.$,s.prototype.setGridSize=s.prototype.aa,s.prototype.setMaxZoom=s.prototype.ba,s.prototype.onAdd=s.prototype.onAdd,s.prototype.draw=s.prototype.draw,l.prototype.getCenter=l.prototype.getCenter,l.prototype.getSize=l.prototype.T,l.prototype.getMarkers=l.prototype.o,_.prototype.onAdd=_.prototype.onAdd,_.prototype.draw=_.prototype.draw,_.prototype.onRemove=_.prototype.onRemove}();